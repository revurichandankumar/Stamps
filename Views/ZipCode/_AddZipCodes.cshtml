@model OneposStamps.Models.GetZipCodeData

@{
    int i = 0;
    int j = 0;
    ViewBag.Title = "AddZipCodes";
}

<div class="row collzips" id="wrapper">
    <div class="col-md-5">
        <div class="d-flex mb-2">
            <h5 class="font-weight-bold m-0">Search Results</h5>
            @*<a href="#" id="btnSelectAll" name="btnSelectAll" class="btn btn-primary table-btn ml-auto">Select All</a>*@
            <button id="btnSelectAll" name="btnSelectAll" style="display:none" class="btn btn-primary table-btn ml-auto">Select All</button>
        </div>
        <div class="card" style="height: 575px;overflow-y: scroll;">
            <div class="card-body">
                <div class="accordion" id="divSearchResult">

                    @foreach (var item in Model.GroupbyZipCodeList)
                    {
                        string headerid = "Aheading" + i;
                        string collapseid = "Acollapse" + i;
                        if (i == 0)
                        {
                            <div class="card border mb-1 shadow-none">
                                <div class="card-header" id="@headerid">
                                    <a href="" data-name="aCityNameAdd" class="text-dark" data-toggle="collapse" data-target="#@collapseid" aria-expanded="true" aria-controls="@collapseid">
                                        @item.Select(x => x.Name).FirstOrDefault()
                                    </a>
                                    <button name="btnAdd" class="btn btn-primary table-btn ml-auto">Add</button>
                                </div>

                                <div id="@collapseid" class="collapse show" aria-labelledby="@headerid" data-parent="#divSearchResult">
                                    <div class="card-body">
                                        <ul class="list-unstyled ziplist">
                                            @foreach (var zip in item)
                                            {
                                                <li class="d-flex" data-name="liZipcodeAdd">@zip.Zipcode <span name="span_ZipcodeAdd" class="ml-auto fa fa-plus text-primary"></span></li>
                                            }

                                        </ul>
                                    </div>
                                </div>

                            </div>
                            i++;
                        }
                        else
                        {
                            <div class="card mb-1 border shadow-none">
                                <div class="card-header" id="@headerid">
                                    <a href="" data-name="aCityNameAdd" class="collapsed text-dark" data-toggle="collapse" data-target="#@collapseid" aria-expanded="false" aria-controls="@collapseid">
                                        @item.Select(x => x.Name).FirstOrDefault()
                                    </a>
                                    <button name="btnAdd" class="btn btn-primary table-btn ml-auto">Add</button>
                                </div>
                                <div id="@collapseid" class="collapse" aria-labelledby="@headerid" data-parent="#divSearchResult">
                                    <div class="card-body">
                                        <ul class="list-unstyled ziplist">
                                            @foreach (var zip in item)
                                            {
                                                <li class="d-flex" data-name="liZipcodeAdd">@zip.Zipcode <span name="span_ZipcodeAdd" class="ml-auto fa fa-plus text-primary"></span></li>
                                            }

                                        </ul>
                                    </div>
                                </div>
                            </div>
                            i++;
                        }

                    }

                    <span style="display:none">@i = 0</span>

                </div>
            </div>
        </div>
    </div>
    <div class="col-md-2 text-center align-self-center">
        <i class="fas fa-arrows-alt-h fa-3x"></i>
    </div>
    <div class="col-md-5">
        <div class="d-flex mb-2">
            <h5 class="font-weight-bold m-0">Added Zip Codes</h5>
            @*<a href="#" class="btn btn-danger table-btn ml-auto">Delete All</a>*@
            <button id="btnDeleteAll" name="btnDeleteAll" style="display:none" class="btn btn-danger table-btn ml-auto">Delete All</button>

        </div>
        <div class="card" style="height: 575px;overflow-y: scroll;">
            <div class="card-body">
                <div class="accordion" id="addedZipcodes">
                    @foreach (var item in Model.GroupbyAddedZipCodeList)
                    {
                        string Rheaderid = "Rheading" + j;
                        string Rcollapseid = "Rcollapse" + j;
                        if (j == 0)
                        {
                            <div class="card border mb-1 shadow-none">
                                <div class="card-header" id="@Rheaderid">
                                    <a href="" data-name="aCityNameRemove" class="text-dark" data-toggle="collapse" data-target="#@Rcollapseid" aria-expanded="true" aria-controls="@Rcollapseid">
                                        @item.Select(x => x.Name).FirstOrDefault()
                                    </a>
                                    <button name="btnRemove" class="btn btn-danger table-btn ml-auto">Delete</button>
                                </div>
                                <div id="@Rcollapseid" class="collapse show" aria-labelledby="@Rheaderid" data-parent="#addedZipcodes">
                                    <div class="card-body">
                                        <ul class="list-unstyled ziplist">
                                            @foreach (var zip in item)
                                            {
                                                <li class="d-flex" data-name="liZipcodeRemove">@zip.Zipcode <span name="span_ZipcodeRemove" class="ml-auto fa fa-minus text-danger"></span></li>
                                            }
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            j++;
                        }
                        else
                        {
                            <div class="card mb-1 border shadow-none">
                                <div class="card-header" id="@Rheaderid">
                                    <a href="" data-name="aCityNameRemove" class="collapsed text-dark" data-toggle="collapse" data-target="#@Rcollapseid" aria-expanded="false" aria-controls="@Rcollapseid">
                                        @item.Select(x => x.Name).FirstOrDefault()
                                    </a>
                                    <button name="btnRemove" class="btn btn-danger table-btn ml-auto">Delete</button>
                                </div>
                                <div id="@Rcollapseid" class="collapse" aria-labelledby="@Rheaderid" data-parent="#addedZipcodes">
                                    <div class="card-body">
                                        <ul class="list-unstyled ziplist">
                                            @foreach (var zip in item)
                                            {
                                                <li class="d-flex" data-name="liZipcodeRemove">@zip.Zipcode <span name="span_ZipcodeRemove" class="ml-auto fa fa-minus text-danger"></span></li>
                                            }
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            j++;
                        }

                    }

                    <span style="display:none">@j = 0</span>

                </div>
            </div>
        </div>
    </div>
</div>

<script>

    $(document).on('click', 'span', function () { 
    //$('#wrapper').on('click', 'span', function () {
    //$('span').on('click', function () {

        debugger
        if ($(this).attr('name') == 'span_ZipcodeAdd') {
            var cityname = $(this).closest('li').parent().parent().parent().parent().find('[data-name="aCityNameAdd"]')[0].innerText;
            var zipcode = $(this).closest('li')[0].innerText;

            var divAddedZipCode = $('#addedZipcodes').find('.card-header');

            if (divAddedZipCode.length > 0) {
                var checkExists = 0;
                for (var i = 0; i < divAddedZipCode.length; i++) {
                    if (divAddedZipCode[i].children[0].innerText == cityname) {


                        for (var j = 0; j < divAddedZipCode.length; j++) {
                            if (divAddedZipCode[j].children[0].ariaExpanded == "true") {
                                divAddedZipCode[j].children[0].ariaExpanded = false;
                                divAddedZipCode[j].children[0].className = 'text-dark collapsed';
                                divAddedZipCode[j].nextElementSibling.className = 'collapse';
                                break;
                            }
                        }

                        var appendStringLi = $('<li class="d-flex" data-name="liZipcodeRemove"><span name="span_ZipcodeRemove" class="ml-auto fa fa-minus text-danger"></span></li>');
                        appendStringLi.html(zipcode + '<span name="span_ZipcodeRemove" class="ml-auto fa fa-minus text-danger"></span>');

                        divAddedZipCode[i].nextElementSibling.children[0].children[0].append(appendStringLi[0]);
                        $(this).closest('li').remove();

                        divAddedZipCode[i].children[0].ariaExpanded = true;
                        divAddedZipCode[i].children[0].className = 'text-dark';
                        divAddedZipCode[i].nextElementSibling.className = 'collapse show';

                        checkExists = 1;
                        break;
                    }
                }
                if (checkExists == 0) {
                    // to create a new card
                    var idcount = divAddedZipCode.length;
                    var headerid = 'Rheading' + idcount;
                    var collapseid = 'Rcollapse' + idcount;

                    for (var i = 0; i < divAddedZipCode.length; i++) {
                        if (divAddedZipCode[i].children[0].ariaExpanded == "true") {
                            divAddedZipCode[i].children[0].ariaExpanded = false;
                            divAddedZipCode[i].children[0].className = 'text-dark collapsed';
                            divAddedZipCode[i].nextElementSibling.className = 'collapse';
                            break;
                        }
                    }

                    var appendStringMainDiv = $('<div class="card mb-1 border shadow-none"></div>');
                    var appendStringChildDiv = $('<div class="card-header" id="' + headerid + '"><a href = "" data-name="aCityNameRemove" class= "text-dark" data-toggle="collapse" ' +
                        ' data-target="#' + collapseid + '" aria-expanded="true" aria-controls="' + collapseid + '" >' + cityname + '</a> ' +
                        ' <button name="btnRemove" class="btn btn-danger table-btn ml-auto">Delete</button></div>');
                    appendStringMainDiv.html(appendStringChildDiv);

                    var appendStringSecondChildDiv = $('<div id = "' + collapseid + '" class= "collapse show" aria-labelledby="' + headerid + '" ' +
                        ' data-parent="#addedZipcodes" > <div class="card-body"> <ul class="list-unstyled ziplist"> ' +
                        ' <li class="d-flex" data-name="liZipcodeRemove"> ' + zipcode + ' <span name="span_ZipcodeRemove" class="ml-auto fa fa-minus text-danger"></span></li></ul></div></div>')
                    appendStringMainDiv.append(appendStringSecondChildDiv);

                    $("#addedZipcodes").append(appendStringMainDiv);

                    if ($(this).closest('li').length == 1) {
                        $(this).closest('li').parent().parent().parent().parent().remove();
                    }
                    $(this).closest('li').remove();
                }
            }
            else {

                var idcount = divAddedZipCode.length;
                var headerid = 'Rheading' + idcount;
                var collapseid = 'Rcollapse' + idcount;

                for (var i = 0; i < divAddedZipCode.length; i++) {
                    if (divAddedZipCode[i].children[0].ariaExpanded == "true") {
                        divAddedZipCode[i].children[0].ariaExpanded = false;
                        divAddedZipCode[i].children[0].className = 'text-dark collapsed';
                        divAddedZipCode[i].nextElementSibling.className = 'collapse';
                        break;
                    }
                }

                var appendStringMainDiv = $('<div class="card mb-1 border shadow-none"></div>');
                var appendStringChildDiv = $('<div class="card-header" id="' + headerid + '"><a href = "" data-name="aCityNameRemove" class= "text-dark" data-toggle="collapse" ' +
                    ' data-target="#' + collapseid + '" aria-expanded="true" aria-controls="' + collapseid + '" >' + cityname + '</a> ' +
                    ' <button name="btnRemove" class="btn btn-danger table-btn ml-auto">Delete</button></div>');
                appendStringMainDiv.html(appendStringChildDiv);

                var appendStringSecondChildDiv = $('<div id = "' + collapseid + '" class= "collapse show" aria-labelledby="' + headerid + '" ' +
                    ' data-parent="#addedZipcodes" > <div class="card-body"> <ul class="list-unstyled ziplist"> ' +
                    ' <li class="d-flex" data-name="liZipcodeRemove"> ' + zipcode + ' <span name="span_ZipcodeRemove" class="ml-auto fa fa-minus text-danger"></span></li></ul></div></div>')
                appendStringMainDiv.append(appendStringSecondChildDiv);

                $("#addedZipcodes").append(appendStringMainDiv);

                $(this).closest('li').remove();

            }

        }

        // -------------- To remove from added list ----------------------

        else if ($(this).attr('name') == 'span_ZipcodeRemove') {
            debugger
            var cityname = $(this).closest('li').parent().parent().parent().parent().find('[data-name="aCityNameRemove"]')[0].innerText;
            var zipcode = $(this).closest('li')[0].innerText;

            var divAddedZipCode = $('#divSearchResult').find('.card-header');

            if (divAddedZipCode.length > 0) {
                var checkExists = 0;
                for (var i = 0; i < divAddedZipCode.length; i++) {
                    if (divAddedZipCode[i].children[0].innerText == cityname) {


                        for (var j = 0; j < divAddedZipCode.length; j++) {
                            if (divAddedZipCode[j].children[0].ariaExpanded == "true") {
                                divAddedZipCode[j].children[0].ariaExpanded = false;
                                divAddedZipCode[j].children[0].className = 'text-dark collapsed';
                                divAddedZipCode[j].nextElementSibling.className = 'collapse';
                                break;
                            }
                        }

                        var appendStringLi = $('<li class="d-flex" data-name="liZipcodeAdd"><span name="span_ZipcodeAdd" class="ml-auto fa fa-plus text-primary"></span></li>');
                        appendStringLi.html(zipcode + '<span  name="span_ZipcodeAdd" class="ml-auto fa fa-plus text-primary""></span>');

                        divAddedZipCode[i].nextElementSibling.children[0].children[0].append(appendStringLi[0]);
                        $(this).closest('li').remove();

                        divAddedZipCode[i].children[0].ariaExpanded = true;
                        divAddedZipCode[i].children[0].className = 'text-dark';
                        divAddedZipCode[i].nextElementSibling.className = 'collapse show';

                        checkExists = 1;
                        break;
                    }
                }
                if (checkExists == 0) {
                    // to create a new card
                    var idcount = divAddedZipCode.length;
                    var headerid = 'Aheading' + idcount;
                    var collapseid = 'Acollapse' + idcount;

                    for (var i = 0; i < divAddedZipCode.length; i++) {
                        if (divAddedZipCode[i].children[0].ariaExpanded == "true") {
                            divAddedZipCode[i].children[0].ariaExpanded = false;
                            divAddedZipCode[i].children[0].className = 'text-dark collapsed';
                            divAddedZipCode[i].nextElementSibling.className = 'collapse';
                            break;
                        }
                    }

                    var appendStringMainDiv = $('<div class="card border mb-1 shadow-none"></div>');
                    var appendStringChildDiv = $('<div class="card-header" id="' + headerid + '"><a href = "" data-name="aCityNameAdd"  class= "text-dark" data-toggle="collapse" ' +
                        ' data-target="#' + collapseid + '" aria-expanded="true" aria-controls="' + collapseid + '" >' + cityname + '</a> ' +
                        ' <button name="btnAdd" class="btn btn-primary table-btn ml-auto">Add</button></div>');
                    appendStringMainDiv.html(appendStringChildDiv);

                    var appendStringSecondChildDiv = $('<div id = "' + collapseid + '" class= "collapse show" aria-labelledby="' + headerid + '" ' +
                        ' data-parent="#divSearchResult" > <div class="card-body"> <ul class="list-unstyled ziplist"> ' +
                        ' <li class="d-flex" data-name="liZipcodeAdd"> ' + zipcode + ' <span name="span_ZipcodeAdd" class="ml-auto fa fa-plus text-primary"></span></li></ul></div></div>')
                    appendStringMainDiv.append(appendStringSecondChildDiv);

                    $("#divSearchResult").append(appendStringMainDiv);

                    $(this).closest('li').remove();
                }
            }
            else {

                var idcount = divAddedZipCode.length;
                var headerid = 'Aheading' + idcount;
                var collapseid = 'Acollapse' + idcount;

                for (var i = 0; i < divAddedZipCode.length; i++) {
                    if (divAddedZipCode[i].children[0].ariaExpanded == "true") {
                        divAddedZipCode[i].children[0].ariaExpanded = false;
                        divAddedZipCode[i].children[0].className = 'text-dark collapsed';
                        divAddedZipCode[i].nextElementSibling.className = 'collapse';
                        break;
                    }
                }

                var appendStringMainDiv = $('<div class="card border mb-1 shadow-none"></div>');
                var appendStringChildDiv = $('<div class="card-header" id="' + headerid + '"><a href = "" data-name="aCityNameAdd"  class= "text-dark" data-toggle="collapse" ' +
                    ' data-target="#' + collapseid + '" aria-expanded="true" aria-controls="' + collapseid + '" >' + cityname + '</a> ' +
                    ' <button name="btnAdd" class="btn btn-primary table-btn ml-auto">Add</button></div>');
                appendStringMainDiv.html(appendStringChildDiv);

                var appendStringSecondChildDiv = $('<div id = "' + collapseid + '" class= "collapse show" aria-labelledby="' + headerid + '" ' +
                    ' data-parent="#divSearchResult" > <div class="card-body"> <ul class="list-unstyled ziplist"> ' +
                    ' <li class="d-flex" data-name="liZipcodeAdd"> ' + zipcode + ' <span name="span_ZipcodeAdd" class="ml-auto fa fa-plus text-primary"></span></li></ul></div></div>')
                appendStringMainDiv.append(appendStringSecondChildDiv);

                $("#divSearchResult").append(appendStringMainDiv);

                $(this).closest('li').remove();

            }
        }
    })

    $(document).on('click', 'button', function () { 
    //$('button').on('click', function () {
        debugger
        if ($(this).attr('name') == 'btnAdd') {

            var cityname = $(this)[0].previousElementSibling.innerText;

            var zipListNode = $(this).parent()[0].nextElementSibling.children[0].children[0].children;
            var zipcodeList = [];
            for (var i = 0; i < zipListNode.length; i++) {
                zipcodeList.push(zipListNode[i].innerText);
            }

            if (zipListNode.length <= 0) {
                alert("No zipcodes to be added.");
                return false;
            }

            var divAddedZipCode = $('#addedZipcodes').find('.card-header');

            if (divAddedZipCode.length > 0) {
                var checkExists = 0;
                for (var i = 0; i < divAddedZipCode.length; i++) {
                    if (divAddedZipCode[i].children[0].innerText == cityname) {


                        for (var j = 0; j < divAddedZipCode.length; j++) {
                            if (divAddedZipCode[j].children[0].ariaExpanded == "true") {
                                divAddedZipCode[j].children[0].ariaExpanded = false;
                                divAddedZipCode[j].children[0].className = 'text-dark collapsed';
                                divAddedZipCode[j].nextElementSibling.className = 'collapse';
                                break;
                            }
                        }

                        //var appendStringLi = $('<li class="d-flex"><span class="ml-auto fa fa-minus text-danger"></span></li>');
                        //appendStringLi.html(zipcode + '<span class="ml-auto fa fa-minus text-danger"></span>');

                        var liString = "";
                        for (var k = 0; k < zipcodeList.length; k++) {
                            liString += '<li class="d-flex" data-name="liZipcodeRemove">' + zipcodeList[k] + '<span name="span_ZipcodeRemove" class="ml-auto fa fa-minus text-danger"></span></li>';
                        }

                        var appendStringLi = $(liString);

                        divAddedZipCode[i].nextElementSibling.children[0].children[0].append(appendStringLi[0]);

                        var nodeRemoveLength = zipListNode.length;
                        for (var l = 0; l < nodeRemoveLength; l++) {
                            zipListNode[0].remove();
                        }

                        divAddedZipCode[i].children[0].ariaExpanded = true;
                        divAddedZipCode[i].children[0].className = 'text-dark';
                        divAddedZipCode[i].nextElementSibling.className = 'collapse show';

                        checkExists = 1;
                        break;
                    }
                }
                if (checkExists == 0) {
                    // to create a new card
                    var idcount = divAddedZipCode.length;
                    var headerid = 'Rheading' + idcount;
                    var collapseid = 'Rcollapse' + idcount;

                    for (var i = 0; i < divAddedZipCode.length; i++) {
                        if (divAddedZipCode[i].children[0].ariaExpanded == "true") {
                            divAddedZipCode[i].children[0].ariaExpanded = false;
                            divAddedZipCode[i].children[0].className = 'text-dark collapsed';
                            divAddedZipCode[i].nextElementSibling.className = 'collapse';
                            break;
                        }
                    }

                    var appendStringLi = "";
                    for (var j = 0; j < zipcodeList.length; j++) {
                        appendStringLi += '<li class="d-flex" data-name="liZipcodeRemove">' + zipcodeList[j] + '<span name="span_ZipcodeRemove" class="ml-auto fa fa-minus text-danger"></span></li>';
                    }

                    var appendStringMainDiv = $('<div class="card mb-1 border shadow-none"></div>');
                    var appendStringChildDiv = $('<div class="card-header" id="' + headerid + '"><a href = "" data-name="aCityNameRemove" class= "text-dark" data-toggle="collapse" ' +
                        ' data-target="#' + collapseid + '" aria-expanded="true" aria-controls="' + collapseid + '" >' + cityname + '</a> ' +
                        ' <button name="btnRemove" class="btn btn-danger table-btn ml-auto">Delete</button></div>');
                    appendStringMainDiv.html(appendStringChildDiv);

                    var appendStringSecondChildDiv = $('<div id = "' + collapseid + '" class= "collapse show" aria-labelledby="' + headerid + '" ' +
                        ' data-parent="#addedZipcodes" > <div class="card-body"> <ul class="list-unstyled ziplist"> ' +
                        ' ' + appendStringLi + '</ul></div></div>')
                    appendStringMainDiv.append(appendStringSecondChildDiv);

                    $("#addedZipcodes").append(appendStringMainDiv);

                    var nodeRemoveLength = zipListNode.length;
                    for (var k = 0; k < nodeRemoveLength; k++) {
                        zipListNode[0].remove();
                    }
                }
            }
            else {

                var idcount = divAddedZipCode.length;
                var headerid = 'Rheading' + idcount;
                var collapseid = 'Rcollapse' + idcount;

                for (var i = 0; i < divAddedZipCode.length; i++) {
                    if (divAddedZipCode[i].children[0].ariaExpanded == "true") {
                        divAddedZipCode[i].children[0].ariaExpanded = false;
                        divAddedZipCode[i].children[0].className = 'text-dark collapsed';
                        divAddedZipCode[i].nextElementSibling.className = 'collapse';
                        break;
                    }
                }

                var appendStringLi = "";
                for (var j = 0; j < zipcodeList.length; j++) {
                    appendStringLi += '<li class="d-flex" data-name="liZipcodeRemove">' + zipcodeList[j] + '<span name="span_ZipcodeRemove" class="ml-auto fa fa-minus text-danger"></span></li>';
                }

                var appendStringMainDiv = $('<div class="card mb-1 border shadow-none"></div>');
                var appendStringChildDiv = $('<div class="card-header" id="' + headerid + '"><a href = "" data-name="aCityNameRemove" class= "text-dark" data-toggle="collapse" ' +
                    ' data-target="#' + collapseid + '" aria-expanded="true" aria-controls="' + collapseid + '" >' + cityname + '</a> ' +
                    ' <button name="btnRemove" class="btn btn-danger table-btn ml-auto">Delete</button></div>');
                appendStringMainDiv.html(appendStringChildDiv);

                var appendStringSecondChildDiv = $('<div id = "' + collapseid + '" class= "collapse show" aria-labelledby="' + headerid + '" ' +
                    ' data-parent="#addedZipcodes" > <div class="card-body"> <ul class="list-unstyled ziplist"> ' +
                    ' ' + appendStringLi + '</ul></div></div>')
                appendStringMainDiv.append(appendStringSecondChildDiv);

                $("#addedZipcodes").append(appendStringMainDiv);

                var nodeRemoveLength = zipListNode.length;
                for (var k = 0; k < nodeRemoveLength; k++) {
                    zipListNode[0].remove();
                }
            }


        }

        // -------------- To remove from added list ----------------------

        else if ($(this).attr('name') == 'btnRemove') {

            var cityname = $(this)[0].previousElementSibling.innerText;

            var zipListNode = $(this).parent()[0].nextElementSibling.children[0].children[0].children;
            var zipcodeList = [];
            for (var i = 0; i < zipListNode.length; i++) {
                zipcodeList.push(zipListNode[i].innerText);
            }

            if (zipListNode.length <= 0) {
                alert("No zipcodes to be removed.");
                return false;
            }

            var divAddedZipCode = $('#divSearchResult').find('.card-header');

            if (divAddedZipCode.length > 0) {
                var checkExists = 0;
                for (var i = 0; i < divAddedZipCode.length; i++) {
                    if (divAddedZipCode[i].children[0].innerText == cityname) {


                        for (var j = 0; j < divAddedZipCode.length; j++) {
                            if (divAddedZipCode[j].children[0].ariaExpanded == "true") {
                                divAddedZipCode[j].children[0].ariaExpanded = false;
                                divAddedZipCode[j].children[0].className = 'text-dark collapsed';
                                divAddedZipCode[j].nextElementSibling.className = 'collapse';
                                break;
                            }
                        }

                        //var appendStringLi = $('<li class="d-flex"><span class="ml-auto fa fa-minus text-danger"></span></li>');
                        //appendStringLi.html(zipcode + '<span class="ml-auto fa fa-minus text-danger"></span>');

                        var liString = "";
                        for (var k = 0; k < zipcodeList.length; k++) {
                            liString += '<li class="d-flex" data-name="liZipcodeAdd">' + zipcodeList[k] + '<span name="span_ZipcodeAdd" class="ml-auto fa fa-plus text-primary"></span></li>';
                        }

                        var appendStringLi = $(liString);

                        divAddedZipCode[i].nextElementSibling.children[0].children[0].append(appendStringLi[0]);

                        var nodeRemoveLength = zipListNode.length;
                        for (var l = 0; l < nodeRemoveLength; l++) {
                            zipListNode[0].remove();
                        }

                        divAddedZipCode[i].children[0].ariaExpanded = true;
                        divAddedZipCode[i].children[0].className = 'text-dark';
                        divAddedZipCode[i].nextElementSibling.className = 'collapse show';

                        checkExists = 1;
                        break;
                    }
                }
                if (checkExists == 0) {
                    // to create a new card
                    var idcount = divAddedZipCode.length;
                    var headerid = 'Aheading' + idcount;
                    var collapseid = 'Acollapse' + idcount;

                    for (var i = 0; i < divAddedZipCode.length; i++) {
                        if (divAddedZipCode[i].children[0].ariaExpanded == "true") {
                            divAddedZipCode[i].children[0].ariaExpanded = false;
                            divAddedZipCode[i].children[0].className = 'text-dark collapsed';
                            divAddedZipCode[i].nextElementSibling.className = 'collapse';
                            break;
                        }
                    }

                    var appendStringLi = "";
                    for (var j = 0; j < zipcodeList.length; j++) {
                        appendStringLi += '<li class="d-flex" data-name="liZipcodeAdd">' + zipcodeList[j] + '<span name="span_ZipcodeAdd" class="ml-auto fa fa-plus text-primary"></span></li>';
                    }

                    var appendStringMainDiv = $('<div class="card border mb-1 shadow-none"></div>');
                    var appendStringChildDiv = $('<div class="card-header" id="' + headerid + '"><a href = "" data-name="aCityNameAdd"  class= "text-dark" data-toggle="collapse" ' +
                        ' data-target="#' + collapseid + '" aria-expanded="true" aria-controls="' + collapseid + '" >' + cityname + '</a> ' +
                        ' <button name="btnAdd" class="btn btn-primary table-btn ml-auto">Add</button></div>');
                    appendStringMainDiv.html(appendStringChildDiv);

                    var appendStringSecondChildDiv = $('<div id = "' + collapseid + '" class= "collapse show" aria-labelledby="' + headerid + '" ' +
                        ' data-parent="#divSearchResult" > <div class="card-body"> <ul class="list-unstyled ziplist"> ' +
                        ' ' + appendStringLi + '</ul></div></div>');
                    appendStringMainDiv.append(appendStringSecondChildDiv);

                    $("#divSearchResult").append(appendStringMainDiv);

                    var nodeRemoveLength = zipListNode.length;
                    for (var k = 0; k < nodeRemoveLength; k++) {
                        zipListNode[0].remove();
                    }
                }
            }
            else {

                var idcount = divAddedZipCode.length;
                var headerid = 'Aheading' + idcount;
                var collapseid = 'Acollapse' + idcount;

                for (var i = 0; i < divAddedZipCode.length; i++) {
                    if (divAddedZipCode[i].children[0].ariaExpanded == "true") {
                        divAddedZipCode[i].children[0].ariaExpanded = false;
                        divAddedZipCode[i].children[0].className = 'text-dark collapsed';
                        divAddedZipCode[i].nextElementSibling.className = 'collapse';
                        break;
                    }
                }

                var appendStringLi = "";
                for (var j = 0; j < zipcodeList.length; j++) {
                    appendStringLi += '<li class="d-flex" data-name="liZipcodeAdd">' + zipcodeList[j] + '<span name="span_ZipcodeAdd" class="ml-auto fa fa-plus text-primary"></span></li>';
                }

                var appendStringMainDiv = $('<div class="card border mb-1 shadow-none"></div>');
                var appendStringChildDiv = $('<div class="card-header" id="' + headerid + '"><a href = "" data-name="aCityNameAdd"  class= "text-dark" data-toggle="collapse" ' +
                    ' data-target="#' + collapseid + '" aria-expanded="true" aria-controls="' + collapseid + '" >' + cityname + '</a> ' +
                    ' <button name="btnAdd" class="btn btn-primary table-btn ml-auto">Add</button></div>');
                appendStringMainDiv.html(appendStringChildDiv);

                var appendStringSecondChildDiv = $('<div id = "' + collapseid + '" class= "collapse show" aria-labelledby="' + headerid + '" ' +
                    ' data-parent="#divSearchResult" > <div class="card-body"> <ul class="list-unstyled ziplist"> ' +
                    ' ' + appendStringLi + '</ul></div></div>');
                appendStringMainDiv.append(appendStringSecondChildDiv);

                $("#divSearchResult").append(appendStringMainDiv);

                var nodeRemoveLength = zipListNode.length;
                for (var k = 0; k < nodeRemoveLength; k++) {
                    zipListNode[0].remove();
                }
            }


        }

        //else if ($(this).attr('name') == 'btnAdd') {

        //    var cityname = $(this)[0].previousElementSibling.innerText;

        //    var zipListNode = $(this).parent()[0].nextElementSibling.children[0].children[0].children;
        //    var zipcodeList = [];
        //    for (var i = 0; i < zipListNode.length; i++) {
        //        zipcodeList.push(zipListNode[i].innerText);
        //    }

        //    if (zipListNode.length <= 0) {
        //        alert("No zipcodes to be added.");
        //        return false;
        //    }

        //    var divAddedZipCode = $('#addedZipcodes').find('.card-header');

        //    if (divAddedZipCode.length > 0) {
        //        var checkExists = 0;
        //        for (var i = 0; i < divAddedZipCode.length; i++) {
        //            if (divAddedZipCode[i].children[0].innerText == cityname) {


        //                for (var j = 0; j < divAddedZipCode.length; j++) {
        //                    if (divAddedZipCode[j].children[0].ariaExpanded == "true") {
        //                        divAddedZipCode[j].children[0].ariaExpanded = false;
        //                        divAddedZipCode[j].children[0].className = 'text-dark collapsed';
        //                        divAddedZipCode[j].nextElementSibling.className = 'collapse';
        //                        break;
        //                    }
        //                }

        //                //var appendStringLi = $('<li class="d-flex"><span class="ml-auto fa fa-minus text-danger"></span></li>');
        //                //appendStringLi.html(zipcode + '<span class="ml-auto fa fa-minus text-danger"></span>');

        //                var liString = "";
        //                for (var k = 0; k < zipcodeList.length; k++) {
        //                    liString += '<li class="d-flex" data-name="liZipcodeRemove">' + zipcodeList[k] + '<span name="span_ZipcodeRemove" class="ml-auto fa fa-minus text-danger"></span></li>';
        //                }

        //                var appendStringLi = $(liString);

        //                divAddedZipCode[i].nextElementSibling.children[0].children[0].append(appendStringLi[0]);

        //                var nodeRemoveLength = zipListNode.length;
        //                for (var l = 0; l < nodeRemoveLength; l++) {
        //                    zipListNode[0].remove();
        //                }

        //                divAddedZipCode[i].children[0].ariaExpanded = true;
        //                divAddedZipCode[i].children[0].className = 'text-dark';
        //                divAddedZipCode[i].nextElementSibling.className = 'collapse show';

        //                checkExists = 1;
        //                break;
        //            }
        //        }
        //        if (checkExists == 0) {
        //            // to create a new card
        //            var idcount = divAddedZipCode.length;
        //            var headerid = 'Aheading' + idcount;
        //            var collapseid = 'Acollapse' + idcount;

        //            for (var i = 0; i < divAddedZipCode.length; i++) {
        //                if (divAddedZipCode[i].children[0].ariaExpanded == "true") {
        //                    divAddedZipCode[i].children[0].ariaExpanded = false;
        //                    divAddedZipCode[i].children[0].className = 'text-dark collapsed';
        //                    divAddedZipCode[i].nextElementSibling.className = 'collapse';
        //                    break;
        //                }
        //            }

        //            var appendStringLi = "";
        //            for (var j = 0; j < zipcodeList.length; j++) {
        //                appendStringLi += '<li class="d-flex" data-name="liZipcodeRemove">' + zipcodeList[j] + '<span name="span_ZipcodeRemove" class="ml-auto fa fa-minus text-danger"></span></li>';
        //            }

        //            var appendStringMainDiv = $('<div class="card mb-1 border shadow-none"></div>');
        //            var appendStringChildDiv = $('<div class="card-header" id="' + headerid + '"><a href = "" class= "text-dark" data-toggle="collapse" ' +
        //                ' data-target="#' + collapseid + '" aria-expanded="true" aria-controls="' + collapseid + '" >' + cityname + '</a> ' +
        //                ' <button name="btnRemove" class="btn btn-danger table-btn ml-auto">Delete</button></div>');
        //            appendStringMainDiv.html(appendStringChildDiv);

        //            var appendStringSecondChildDiv = $('<div id = "' + collapseid + '" class= "collapse show" aria-labelledby="' + headerid + '" ' +
        //                ' data-parent="#addedZipcodes" > <div class="card-body"> <ul class="list-unstyled ziplist"> ' +
        //                ' ' + appendStringLi + '</ul></div></div>')
        //            appendStringMainDiv.append(appendStringSecondChildDiv);

        //            $("#addedZipcodes").append(appendStringMainDiv);

        //            var nodeRemoveLength = zipListNode.length;
        //            for (var k = 0; k < nodeRemoveLength; k++) {
        //                zipListNode[0].remove();
        //            }
        //        }
        //    }
        //    else {

        //        var idcount = divAddedZipCode.length;
        //        var headerid = 'Aheading' + idcount;
        //        var collapseid = 'Acollapse' + idcount;

        //        for (var i = 0; i < divAddedZipCode.length; i++) {
        //            if (divAddedZipCode[i].children[0].ariaExpanded == "true") {
        //                divAddedZipCode[i].children[0].ariaExpanded = false;
        //                divAddedZipCode[i].children[0].className = 'text-dark collapsed';
        //                divAddedZipCode[i].nextElementSibling.className = 'collapse';
        //                break;
        //            }
        //        }

        //        var appendStringLi = "";
        //        for (var j = 0; j < zipcodeList.length; j++) {
        //            appendStringLi += '<li class="d-flex" data-name="liZipcodeRemove">' + zipcodeList[j] + '<span name="span_ZipcodeRemove" class="ml-auto fa fa-minus text-danger"></span></li>';
        //        }

        //        var appendStringMainDiv = $('<div class="card mb-1 border shadow-none"></div>');
        //        var appendStringChildDiv = $('<div class="card-header" id="' + headerid + '"><a href = "" class= "text-dark" data-toggle="collapse" ' +
        //            ' data-target="#' + collapseid + '" aria-expanded="true" aria-controls="' + collapseid + '" >' + cityname + '</a> ' +
        //            ' <button name="btnRemove" class="btn btn-danger table-btn ml-auto">Delete</button></div>');
        //        appendStringMainDiv.html(appendStringChildDiv);

        //        var appendStringSecondChildDiv = $('<div id = "' + collapseid + '" class= "collapse show" aria-labelledby="' + headerid + '" ' +
        //            ' data-parent="#addedZipcodes" > <div class="card-body"> <ul class="list-unstyled ziplist"> ' +
        //            ' ' + appendStringLi + '</ul></div></div>')
        //        appendStringMainDiv.append(appendStringSecondChildDiv);

        //        $("#addedZipcodes").append(appendStringMainDiv);

        //        var nodeRemoveLength = zipListNode.length;
        //        for (var k = 0; k < nodeRemoveLength; k++) {
        //            zipListNode[0].remove();
        //        }
        //    }


        //}

    });

</script>